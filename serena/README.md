# Serena ワークスペース

このディレクトリは、AI アシスタント **serena** による調査記録と実装進行記録を管理するための専用ワークスペースです。

## ディレクトリ構成

```
serena/
├── README.md              # このファイル (運用ガイド)
├── investigations/        # 調査記録アーカイブ
└── progress/             # 実装進行記録アーカイブ
```

## 各ディレクトリの役割

### `investigations/` - 調査記録アーカイブ

**目的**: 問題調査、バグ解析、仕様調査などの記録を保管

**内容例**:
- issue_01_dp3_mqtt_no_response.md
- issue_02_response_decode_interpret_error.md
- issue_03_data_analysis_and_mapping_update.md
- など

**命名規則**: `issue_XX_<調査内容の簡潔な説明>.md`

**記録すべき情報**:
- 調査の背景と目的
- 調査手法と使用したツール
- 発見事項と分析結果
- 結論と推奨事項
- タイムスタンプと調査者

### `progress/` - 実装進行記録アーカイブ

**目的**: 完了したタスクの実装記録、設計判断、技術調査結果を保管

**内容例**:
- 00_00_DP3_仕様調査タスク.md
- 05_DP3_MQTTキャプチャ環境構築タスク.md
- 06_DP3_Protobufスキーマ解析作成タスク.md
- など

**命名規則**: `XX_<タスク名>.md` (XX は連番)

**記録すべき情報**:
- タスクの目標と要件
- 実装アプローチと設計判断
- 技術的な詳細 (コード例、設定など)
- テスト結果と検証内容
- 次のタスクへの引き継ぎ事項

## 運用ルール

### Serena の役割

Serena は以下の活動を担当します:

1. **調査活動**
   - バグやエラーの原因調査
   - 新技術・新仕様の調査
   - パフォーマンス分析
   - セキュリティ監査

2. **記録管理**
   - 調査結果の文書化
   - 実装完了タスクのアーカイブ
   - ナレッジベースの構築

3. **進行管理サポート**
   - タスク進捗の追跡
   - ブロッカーの特定と報告
   - 次のステップの提案

### 他の AI アシスタントとの連携

- **Claude Code**: 実装作業を担当
  - `tasks/active_context.md` で現在の作業状態を共有
  - `tasks/tasks_plan.md` でタスク全体を管理

- **Serena**: 調査・記録を担当
  - `serena/investigations/` に調査結果を記録
  - `serena/progress/` に完了タスクをアーカイブ

- **共有ナレッジベース**:
  - `docs_4ai/` - AI 向け静的仕様書 (両者が参照)
  - `tasks/` - 現在のタスク状態 (両者が更新)

### ワークフロー

#### 調査タスクの流れ

1. **問題発生/調査依頼**
   - Claude Code または開発者が調査を依頼
   - `tasks/active_context.md` に調査項目を記載

2. **Serena による調査**
   - 問題の再現と分析
   - ログ・データの収集
   - 関連ドキュメントの調査

3. **調査結果の記録**
   - `serena/investigations/issue_XX_<内容>.md` を作成
   - 発見事項と推奨事項を記載
   - `tasks/active_context.md` を更新

4. **実装への引き継ぎ**
   - Claude Code が調査結果を基に実装
   - 必要に応じて追加調査

#### 実装完了タスクのアーカイブ

1. **タスク完了**
   - Claude Code がタスクを完了
   - `tasks/tasks_plan.md` でタスクを完了としてマーク

2. **Serena によるアーカイブ**
   - `tasks/rfc/XX_<タスク名>.md` を確認
   - `serena/progress/` へ移動
   - `tasks/tasks_plan.md` で参照先を更新

3. **ナレッジベース更新**
   - 必要に応じて `docs_4ai/` の仕様書を更新
   - 再利用可能な知見をドキュメント化

## ファイル命名ガイドライン

### 調査記録 (`investigations/`)

```
issue_<番号>_<調査内容>.md

例:
- issue_01_dp3_mqtt_no_response.md
- issue_02_utf8_decode_error.md
- issue_03_performance_analysis.md
```

### 進行記録 (`progress/`)

```
<番号>_<タスク名>.md

例:
- 00_00_DP3_仕様調査タスク.md
- 05_DP3_MQTTキャプチャ環境構築タスク.md
- 06_DP3_Protobufスキーマ解析作成タスク.md
```

## ドキュメントテンプレート

### 調査記録テンプレート

```markdown
# Issue XX: <調査タイトル>

## 概要
- **発生日時**: YYYY-MM-DD
- **調査者**: Serena
- **優先度**: 高/中/低
- **ステータス**: 調査中/完了/保留

## 問題の詳細
[問題の説明]

## 調査手法
[使用したツール、コマンド、手順]

## 発見事項
[調査で明らかになったこと]

## 分析結果
[原因の特定、関連する技術情報]

## 推奨事項
[解決策、回避策、次のアクション]

## 参照資料
- [関連ドキュメント、外部リンク]
```

### 進行記録テンプレート

```markdown
# <タスク番号>: <タスク名>

## タスク概要
- **開始日**: YYYY-MM-DD
- **完了日**: YYYY-MM-DD
- **担当**: Claude Code / Serena
- **ステータス**: 完了

## 目標
[タスクの目的と達成目標]

## 実装内容
[実装したもの、変更点]

## 技術的詳細
[技術的な判断、設計選択、コード例]

## テスト結果
[実施したテスト、検証結果]

## 次のステップ
[後続タスク、残課題]

## 参照資料
- [関連ファイル、ドキュメント]
```

## メンテナンスガイドライン

### 定期的な整理 (月次)

1. **古い記録の整理**
   - 6ヶ月以上前の調査記録をアーカイブ
   - 重要な知見は `docs_4ai/` へ統合

2. **インデックス更新**
   - 主要な調査記録のインデックスを作成
   - カテゴリ別に分類

3. **リンク整合性チェック**
   - `tasks/tasks_plan.md` との参照リンク確認
   - 壊れたリンクの修正

### ファイルサイズ管理

- 大きなログファイル (> 1MB) は別途圧縮または外部保存
- スクリーンショットは適切なサイズに圧縮
- コード例は最小限に抑え、実際のファイルへのリンクを使用

## 参照

- **プロジェクト全体のタスク管理**: [../tasks/tasks_plan.md](../tasks/tasks_plan.md)
- **現在の作業コンテキスト**: [../tasks/active_context.md](../tasks/active_context.md)
- **AI 向け仕様書**: [../docs_4ai/](../docs_4ai/)
- **ブランチ戦略**: [../CLAUDE.md](../CLAUDE.md)

---

**最終更新**: 2025-10-08
